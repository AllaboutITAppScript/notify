<!DOCTYPE html>
<html lang="th">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>üîî ‡∏£‡∏∞‡∏ö‡∏ö‡πÅ‡∏à‡πâ‡∏á‡πÄ‡∏ï‡∏∑‡∏≠‡∏ô‡πÅ‡∏ö‡∏ö‡∏á‡πà‡∏≤‡∏¢</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            background: #1a1a2e;
            color: white;
            font-family: sans-serif;
            padding: 20px;
            max-width: 500px;
            margin: 0 auto;
        }
        
        .container {
            background: #16213e;
            border-radius: 15px;
            padding: 20px;
            margin-bottom: 20px;
        }
        
        h1, h2, h3 {
            color: #64b5f6;
            margin-bottom: 15px;
        }
        
        input, textarea, select, button {
            width: 100%;
            padding: 12px;
            margin-bottom: 10px;
            border: 1px solid #3949ab;
            border-radius: 8px;
            background: #0f3460;
            color: white;
            font-size: 16px;
        }
        
        button {
            background: #3949ab;
            color: white;
            border: none;
            cursor: pointer;
            font-weight: bold;
            transition: 0.3s;
        }
        
        button:hover {
            background: #303f9f;
        }
        
        .btn-primary {
            background: #1976d2;
        }
        
        .btn-success {
            background: #2e7d32;
        }
        
        .btn-danger {
            background: #d32f2f;
        }
        
        .btn-warning {
            background: #f57c00;
        }
        
        .alarm-item {
            background: #0f3460;
            border-left: 4px solid #1976d2;
            padding: 15px;
            margin-bottom: 10px;
            border-radius: 8px;
        }
        
        .alarm-item.public {
            border-left-color: #2e7d32;
        }
        
        .alarm-item.urgent {
            border-left-color: #d32f2f;
            animation: pulse 1s infinite;
        }
        
        @keyframes pulse {
            0% { opacity: 1; }
            50% { opacity: 0.7; }
            100% { opacity: 1; }
        }
        
        .badge {
            display: inline-block;
            padding: 3px 8px;
            border-radius: 10px;
            font-size: 12px;
            margin-right: 5px;
        }
        
        .badge-public {
            background: #2e7d32;
        }
        
        .badge-private {
            background: #1976d2;
        }
        
        .badge-urgent {
            background: #d32f2f;
        }
        
        .notification {
            position: fixed;
            top: 20px;
            right: 20px;
            background: #1a1a2e;
            border: 2px solid #64b5f6;
            border-radius: 10px;
            padding: 15px;
            max-width: 300px;
            z-index: 1000;
            display: none;
        }
        
        .notification.show {
            display: block;
            animation: slideIn 0.3s;
        }
        
        @keyframes slideIn {
            from { transform: translateX(100%); opacity: 0; }
            to { transform: translateX(0); opacity: 1; }
        }
        
        .controls {
            display: flex;
            gap: 10px;
            margin-top: 10px;
        }
        
        .controls button {
            flex: 1;
        }
        
        .status {
            background: #0f3460;
            padding: 10px;
            border-radius: 8px;
            margin-bottom: 15px;
            text-align: center;
        }
        
        .status.online {
            border: 2px solid #4caf50;
        }
        
        .status.offline {
            border: 2px solid #f44336;
        }
        
        #loading {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: #1a1a2e;
            display: flex;
            justify-content: center;
            align-items: center;
            z-index: 9999;
        }
    </style>
</head>
<body>
    <div id="loading">
        <h2>‡∏Å‡∏≥‡∏•‡∏±‡∏á‡πÇ‡∏´‡∏•‡∏î...</h2>
    </div>

    <div class="notification" id="notification">
        <h3 id="notifTitle">‡∏Å‡∏≤‡∏£‡πÅ‡∏à‡πâ‡∏á‡πÄ‡∏ï‡∏∑‡∏≠‡∏ô</h3>
        <p id="notifMessage">‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°‡πÅ‡∏à‡πâ‡∏á‡πÄ‡∏ï‡∏∑‡∏≠‡∏ô</p>
        <button onclick="closeNotification()">‡∏õ‡∏¥‡∏î</button>
    </div>

    <div class="container">
        <h1>üîî ‡∏£‡∏∞‡∏ö‡∏ö‡πÅ‡∏à‡πâ‡∏á‡πÄ‡∏ï‡∏∑‡∏≠‡∏ô</h1>
        <div class="status online" id="connectionStatus">
            <div>‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞: <span id="statusText">‡∏≠‡∏≠‡∏ô‡πÑ‡∏•‡∏ô‡πå</span></div>
            <div>‡∏≠‡∏∏‡∏õ‡∏Å‡∏£‡∏ì‡πå: <span id="deviceName">-</span></div>
        </div>
        
        <h3>üìÖ ‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏Å‡∏≤‡∏£‡πÅ‡∏à‡πâ‡∏á‡πÄ‡∏ï‡∏∑‡∏≠‡∏ô</h3>
        <input type="text" id="alarmTitle" placeholder="‡∏´‡∏±‡∏ß‡∏Ç‡πâ‡∏≠‡πÅ‡∏à‡πâ‡∏á‡πÄ‡∏ï‡∏∑‡∏≠‡∏ô" required>
        <input type="datetime-local" id="alarmDateTime" required>
        <textarea id="alarmDesc" placeholder="‡∏£‡∏≤‡∏¢‡∏•‡∏∞‡πÄ‡∏≠‡∏µ‡∏¢‡∏î (‡πÑ‡∏°‡πà‡∏à‡∏≥‡πÄ‡∏õ‡πá‡∏ô)" rows="3"></textarea>
        
        <div style="display: flex; gap: 10px; margin-bottom: 10px;">
            <button onclick="setAlarmType('private')" id="btnPrivate" class="btn-primary">üîí ‡∏™‡πà‡∏ß‡∏ô‡∏ï‡∏±‡∏ß</button>
            <button onclick="setAlarmType('public')" id="btnPublic">üåê ‡πÅ‡∏à‡πâ‡∏á‡∏ó‡∏∏‡∏Å‡∏Ñ‡∏ô</button>
        </div>
        
        <div style="display: flex; gap: 10px; margin-bottom: 10px;">
            <button onclick="setPriority('low')" id="btnLow" style="flex: 1">‡∏ï‡πà‡∏≥</button>
            <button onclick="setPriority('medium')" id="btnMedium" class="btn-primary" style="flex: 1">‡∏Å‡∏•‡∏≤‡∏á</button>
            <button onclick="setPriority('high')" id="btnHigh" class="btn-danger" style="flex: 1">‡∏™‡∏π‡∏á</button>
        </div>
        
        <button onclick="addAlarm()" class="btn-success">‚úÖ ‡πÄ‡∏û‡∏¥‡πà‡∏°‡πÅ‡∏à‡πâ‡∏á‡πÄ‡∏ï‡∏∑‡∏≠‡∏ô</button>
    </div>

    <div class="container">
        <h3>‚è∞ ‡πÅ‡∏à‡πâ‡∏á‡πÄ‡∏ï‡∏∑‡∏≠‡∏ô‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î</h3>
        <div style="display: flex; gap: 10px; margin-bottom: 15px;">
            <button onclick="filterAlarms('all')" id="filterAll" class="btn-primary">‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î</button>
            <button onclick="filterAlarms('private')" id="filterPrivate">‡∏™‡πà‡∏ß‡∏ô‡∏ï‡∏±‡∏ß</button>
            <button onclick="filterAlarms('public')" id="filterPublic">‡∏™‡∏≤‡∏ò‡∏≤‡∏£‡∏ì‡∏∞</button>
            <button onclick="filterAlarms('today')" id="filterToday">‡∏ß‡∏±‡∏ô‡∏ô‡∏µ‡πâ</button>
        </div>
        
        <div id="alarmsList">
            <!-- ‡πÅ‡∏à‡πâ‡∏á‡πÄ‡∏ï‡∏∑‡∏≠‡∏ô‡∏à‡∏∞‡πÅ‡∏™‡∏î‡∏á‡∏ó‡∏µ‡πà‡∏ô‡∏µ‡πà -->
        </div>
    </div>

    <div class="container">
        <h3>üì¢ ‡∏™‡πà‡∏á‡∏õ‡∏£‡∏∞‡∏Å‡∏≤‡∏®‡∏î‡πà‡∏ß‡∏ô</h3>
        <input type="text" id="broadcastTitle" placeholder="‡∏´‡∏±‡∏ß‡∏Ç‡πâ‡∏≠‡∏õ‡∏£‡∏∞‡∏Å‡∏≤‡∏®" required>
        <textarea id="broadcastMessage" placeholder="‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°‡∏õ‡∏£‡∏∞‡∏Å‡∏≤‡∏®" rows="3" required></textarea>
        <div class="controls">
            <button onclick="sendBroadcast()" class="btn-warning">üì§ ‡∏™‡πà‡∏á‡∏õ‡∏£‡∏∞‡∏Å‡∏≤‡∏®</button>
            <button onclick="sendEmergency()" class="btn-danger">üö® ‡∏™‡πà‡∏á‡∏î‡πà‡∏ß‡∏ô</button>
        </div>
        
        <h4 style="margin-top: 20px;">‡∏õ‡∏£‡∏∞‡∏Å‡∏≤‡∏®‡∏•‡πà‡∏≤‡∏™‡∏∏‡∏î</h4>
        <div id="broadcastsList">
            <!-- ‡∏õ‡∏£‡∏∞‡∏Å‡∏≤‡∏®‡∏à‡∏∞‡πÅ‡∏™‡∏î‡∏á‡∏ó‡∏µ‡πà‡∏ô‡∏µ‡πà -->
        </div>
    </div>

    <div class="container">
        <h3>‚öôÔ∏è ‡∏Å‡∏≤‡∏£‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤</h3>
        <div style="margin-bottom: 15px;">
            <label>
                <input type="checkbox" id="enableSound" checked> üîä ‡πÄ‡∏õ‡∏¥‡∏î‡πÄ‡∏™‡∏µ‡∏¢‡∏á
            </label>
            <label style="margin-left: 15px;">
                <input type="checkbox" id="enableVibrate" checked> üì≥ ‡∏™‡∏±‡πà‡∏ô‡πÄ‡∏°‡∏∑‡πà‡∏≠‡πÅ‡∏à‡πâ‡∏á‡πÄ‡∏ï‡∏∑‡∏≠‡∏ô
            </label>
        </div>
        
        <div class="controls">
            <button onclick="testNotification()" class="btn-primary">üîî ‡∏ó‡∏î‡∏™‡∏≠‡∏ö‡πÅ‡∏à‡πâ‡∏á‡πÄ‡∏ï‡∏∑‡∏≠‡∏ô</button>
            <button onclick="testBackground()" class="btn-warning">üì± ‡∏ó‡∏î‡∏™‡∏≠‡∏ö‡πÄ‡∏ö‡∏∑‡πâ‡∏≠‡∏á‡∏´‡∏•‡∏±‡∏á</button>
            <button onclick="exportData()" class="btn-success">üíæ ‡∏™‡∏≥‡∏£‡∏≠‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•</button>
        </div>
    </div>

    <script>
        // ‡∏ï‡∏±‡∏ß‡πÅ‡∏õ‡∏£‡∏´‡∏•‡∏±‡∏Å
        let alarms = [];
        let broadcasts = [];
        let deviceId = '';
        let userName = '';
        let currentAlarmType = 'private';
        let currentPriority = 'medium';
        let currentFilter = 'all';
        
        // ‡πÄ‡∏°‡∏∑‡πà‡∏≠‡∏´‡∏ô‡πâ‡∏≤‡πÄ‡∏ß‡πá‡∏ö‡πÇ‡∏´‡∏•‡∏î‡πÄ‡∏™‡∏£‡πá‡∏à
        window.onload = function() {
            initApp();
        };
        
        // ‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏ï‡πâ‡∏ô‡πÅ‡∏≠‡∏õ
        function initApp() {
            console.log('‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏ï‡πâ‡∏ô‡∏£‡∏∞‡∏ö‡∏ö‡πÅ‡∏à‡πâ‡∏á‡πÄ‡∏ï‡∏∑‡∏≠‡∏ô...');
            
            // ‡∏ã‡πà‡∏≠‡∏ô loading screen
            setTimeout(() => {
                document.getElementById('loading').style.display = 'none';
            }, 1000);
            
            // ‡πÇ‡∏´‡∏•‡∏î‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏à‡∏≤‡∏Å localStorage
            loadData();
            
            // ‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤‡∏≠‡∏∏‡∏õ‡∏Å‡∏£‡∏ì‡πå
            setupDevice();
            
            // ‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤ datetime-local ‡πÉ‡∏´‡πâ‡πÄ‡∏õ‡πá‡∏ô‡πÄ‡∏ß‡∏•‡∏≤‡∏õ‡∏±‡∏à‡∏à‡∏∏‡∏ö‡∏±‡∏ô + 1 ‡∏ä‡∏±‡πà‡∏ß‡πÇ‡∏°‡∏á
            const now = new Date();
            now.setHours(now.getHours() + 1);
            document.getElementById('alarmDateTime').value = formatDateTime(now);
            
            // ‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤‡∏ï‡∏±‡∏ß‡∏Å‡∏£‡∏≠‡∏á‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏ï‡πâ‡∏ô
            filterAlarms('all');
            
            // ‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡πÅ‡∏à‡πâ‡∏á‡πÄ‡∏ï‡∏∑‡∏≠‡∏ô‡∏ó‡∏∏‡∏Å‡∏ß‡∏¥‡∏ô‡∏≤‡∏ó‡∏µ
            setInterval(checkAlarms, 1000);
            
            // ‡∏≠‡∏±‡∏û‡πÄ‡∏î‡∏ï‡πÄ‡∏ß‡∏•‡∏≤‡∏ó‡∏∏‡∏Å‡∏ô‡∏≤‡∏ó‡∏µ
            setInterval(updateTime, 60000);
            
            // ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏Å‡∏≤‡∏£‡πÄ‡∏ä‡∏∑‡πà‡∏≠‡∏°‡∏ï‡πà‡∏≠‡∏ó‡∏∏‡∏Å 30 ‡∏ß‡∏¥‡∏ô‡∏≤‡∏ó‡∏µ
            setInterval(checkConnection, 30000);
            
            console.log('‡∏£‡∏∞‡∏ö‡∏ö‡∏û‡∏£‡πâ‡∏≠‡∏°‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô!');
            showNotification('‡∏¢‡∏¥‡∏ô‡∏î‡∏µ‡∏ï‡πâ‡∏≠‡∏ô‡∏£‡∏±‡∏ö', '‡∏£‡∏∞‡∏ö‡∏ö‡πÅ‡∏à‡πâ‡∏á‡πÄ‡∏ï‡∏∑‡∏≠‡∏ô‡∏û‡∏£‡πâ‡∏≠‡∏°‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô‡πÅ‡∏•‡πâ‡∏ß');
        }
        
        // ‡πÇ‡∏´‡∏•‡∏î‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏à‡∏≤‡∏Å localStorage
        function loadData() {
            alarms = JSON.parse(localStorage.getItem('alarms')) || [];
            broadcasts = JSON.parse(localStorage.getItem('broadcasts')) || [];
            
            // ‡πÄ‡∏£‡∏µ‡∏¢‡∏á‡∏•‡∏≥‡∏î‡∏±‡∏ö alarms
            alarms.sort((a, b) => new Date(a.datetime) - new Date(b.datetime));
            
            // ‡πÄ‡∏£‡∏µ‡∏¢‡∏á‡∏•‡∏≥‡∏î‡∏±‡∏ö broadcasts (‡πÉ‡∏´‡∏°‡πà‡∏Ç‡∏∂‡πâ‡∏ô‡∏Å‡πà‡∏≠‡∏ô)
            broadcasts.sort((a, b) => new Date(b.time) - new Date(a.time));
            
            updateAlarmsList();
            updateBroadcastsList();
        }
        
        // ‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏•‡∏á localStorage
        function saveData() {
            localStorage.setItem('alarms', JSON.stringify(alarms));
            localStorage.setItem('broadcasts', JSON.stringify(broadcasts));
        }
        
        // ‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤‡∏≠‡∏∏‡∏õ‡∏Å‡∏£‡∏ì‡πå
        function setupDevice() {
            deviceId = localStorage.getItem('deviceId');
            if (!deviceId) {
                deviceId = 'device_' + Date.now();
                localStorage.setItem('deviceId', deviceId);
            }
            
            userName = localStorage.getItem('userName') || '‡∏ú‡∏π‡πâ‡πÉ‡∏ä‡πâ';
            document.getElementById('deviceName').textContent = userName;
            
            // ‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤‡∏Å‡∏≤‡∏£‡πÅ‡∏à‡πâ‡∏á‡πÄ‡∏ï‡∏∑‡∏≠‡∏ô
            if ('Notification' in window && Notification.permission === 'default') {
                Notification.requestPermission();
            }
        }
        
        // ‡πÄ‡∏û‡∏¥‡πà‡∏°‡πÅ‡∏à‡πâ‡∏á‡πÄ‡∏ï‡∏∑‡∏≠‡∏ô‡πÉ‡∏´‡∏°‡πà
        function addAlarm() {
            const title = document.getElementById('alarmTitle').value.trim();
            const datetime = document.getElementById('alarmDateTime').value;
            const desc = document.getElementById('alarmDesc').value.trim();
            
            if (!title || !datetime) {
                showNotification('‡∏Ç‡πâ‡∏≠‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î', '‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏Å‡∏£‡∏≠‡∏Å‡∏´‡∏±‡∏ß‡∏Ç‡πâ‡∏≠‡πÅ‡∏•‡∏∞‡πÄ‡∏ß‡∏•‡∏≤');
                return;
            }
            
            const alarmTime = new Date(datetime);
            if (alarmTime <= new Date()) {
                showNotification('‡∏Ç‡πâ‡∏≠‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î', '‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏ï‡∏±‡πâ‡∏á‡πÄ‡∏ß‡∏•‡∏≤‡πÉ‡∏ô‡∏≠‡∏ô‡∏≤‡∏Ñ‡∏ï');
                return;
            }
            
            const alarm = {
                id: 'alarm_' + Date.now(),
                title: title,
                description: desc,
                datetime: alarmTime.toISOString(),
                type: currentAlarmType,
                priority: currentPriority,
                triggered: false,
                createdAt: new Date().toISOString(),
                deviceId: deviceId,
                userName: userName
            };
            
            alarms.push(alarm);
            saveData();
            updateAlarmsList();
            
            // ‡∏•‡πâ‡∏≤‡∏á‡∏ü‡∏≠‡∏£‡πå‡∏°
            document.getElementById('alarmTitle').value = '';
            document.getElementById('alarmDesc').value = '';
            
            // ‡∏ï‡∏±‡πâ‡∏á‡πÄ‡∏ß‡∏•‡∏≤‡πÉ‡∏´‡∏°‡πà (1 ‡∏ä‡∏±‡πà‡∏ß‡πÇ‡∏°‡∏á‡∏à‡∏≤‡∏Å‡∏ô‡∏µ‡πâ)
            const nextHour = new Date();
            nextHour.setHours(nextHour.getHours() + 1);
            document.getElementById('alarmDateTime').value = formatDateTime(nextHour);
            
            showNotification('‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à', '‡πÄ‡∏û‡∏¥‡πà‡∏°‡πÅ‡∏à‡πâ‡∏á‡πÄ‡∏ï‡∏∑‡∏≠‡∏ô‡πÅ‡∏•‡πâ‡∏ß: ' + title);
            
            // ‡∏ñ‡πâ‡∏≤‡πÄ‡∏õ‡πá‡∏ô‡πÅ‡∏à‡πâ‡∏á‡πÄ‡∏ï‡∏∑‡∏≠‡∏ô‡∏™‡∏≤‡∏ò‡∏≤‡∏£‡∏ì‡∏∞
            if (currentAlarmType === 'public') {
                shareAlarm(alarm);
            }
        }
        
        // ‡πÅ‡∏ö‡πà‡∏á‡∏õ‡∏±‡∏ô‡πÅ‡∏à‡πâ‡∏á‡πÄ‡∏ï‡∏∑‡∏≠‡∏ô‡∏™‡∏≤‡∏ò‡∏≤‡∏£‡∏ì‡∏∞
        function shareAlarm(alarm) {
            // ‡∏à‡∏≥‡∏•‡∏≠‡∏á‡∏Å‡∏≤‡∏£‡∏™‡πà‡∏á‡πÑ‡∏õ‡∏¢‡∏±‡∏á‡∏≠‡∏∏‡∏õ‡∏Å‡∏£‡∏ì‡πå‡∏≠‡∏∑‡πà‡∏ô
            console.log('‡πÅ‡∏ö‡πà‡∏á‡∏õ‡∏±‡∏ô‡πÅ‡∏à‡πâ‡∏á‡πÄ‡∏ï‡∏∑‡∏≠‡∏ô‡∏™‡∏≤‡∏ò‡∏≤‡∏£‡∏ì‡∏∞:', alarm.title);
            
            // ‡πÉ‡∏ô‡∏™‡∏†‡∏≤‡∏û‡πÅ‡∏ß‡∏î‡∏•‡πâ‡∏≠‡∏°‡∏à‡∏£‡∏¥‡∏á‡∏Ñ‡∏ß‡∏£‡∏™‡πà‡∏á‡∏ú‡πà‡∏≤‡∏ô WebSocket
            showNotification('‡πÅ‡∏à‡πâ‡∏á‡πÄ‡∏ï‡∏∑‡∏≠‡∏ô‡∏™‡∏≤‡∏ò‡∏≤‡∏£‡∏ì‡∏∞', '‡∏™‡πà‡∏á‡πÅ‡∏à‡πâ‡∏á‡πÄ‡∏ï‡∏∑‡∏≠‡∏ô‡πÑ‡∏õ‡∏¢‡∏±‡∏á‡∏≠‡∏∏‡∏õ‡∏Å‡∏£‡∏ì‡πå‡∏≠‡∏∑‡πà‡∏ô‡πÅ‡∏•‡πâ‡∏ß');
        }
        
        // ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡πÅ‡∏à‡πâ‡∏á‡πÄ‡∏ï‡∏∑‡∏≠‡∏ô
        function checkAlarms() {
            const now = new Date();
            
            alarms.forEach(alarm => {
                if (!alarm.triggered && new Date(alarm.datetime) <= now) {
                    triggerAlarm(alarm);
                }
            });
        }
        
        // ‡πÅ‡∏à‡πâ‡∏á‡πÄ‡∏ï‡∏∑‡∏≠‡∏ô‡∏ó‡∏≥‡∏á‡∏≤‡∏ô
        function triggerAlarm(alarm) {
            alarm.triggered = true;
            saveData();
            
            // ‡πÅ‡∏™‡∏î‡∏á‡∏Å‡∏≤‡∏£‡πÅ‡∏à‡πâ‡∏á‡πÄ‡∏ï‡∏∑‡∏≠‡∏ô
            showNotification('üîî ' + alarm.title, alarm.description || '‡πÄ‡∏ß‡∏•‡∏≤‡πÅ‡∏à‡πâ‡∏á‡πÄ‡∏ï‡∏∑‡∏≠‡∏ô‡∏ñ‡∏∂‡∏á‡πÅ‡∏•‡πâ‡∏ß!');
            
            // ‡πÄ‡∏•‡πà‡∏ô‡πÄ‡∏™‡∏µ‡∏¢‡∏á
            if (document.getElementById('enableSound').checked) {
                playSound();
            }
            
            // ‡∏™‡∏±‡πà‡∏ô
            if (document.getElementById('enableVibrate').checked) {
                vibrate();
            }
            
            // ‡∏ñ‡πâ‡∏≤‡πÄ‡∏õ‡πá‡∏ô‡πÅ‡∏à‡πâ‡∏á‡πÄ‡∏ï‡∏∑‡∏≠‡∏ô‡∏î‡πà‡∏ß‡∏ô
            if (alarm.priority === 'high') {
                showEmergencyAlert(alarm);
            }
            
            updateAlarmsList();
        }
        
        // ‡∏™‡πà‡∏á‡∏õ‡∏£‡∏∞‡∏Å‡∏≤‡∏®
        function sendBroadcast() {
            sendBroadcastMessage(false);
        }
        
        // ‡∏™‡πà‡∏á‡∏õ‡∏£‡∏∞‡∏Å‡∏≤‡∏®‡∏î‡πà‡∏ß‡∏ô
        function sendEmergency() {
            sendBroadcastMessage(true);
        }
        
        // ‡∏™‡πà‡∏á‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°‡∏õ‡∏£‡∏∞‡∏Å‡∏≤‡∏®
        function sendBroadcastMessage(urgent) {
            const title = document.getElementById('broadcastTitle').value.trim();
            const message = document.getElementById('broadcastMessage').value.trim();
            
            if (!title || !message) {
                showNotification('‡∏Ç‡πâ‡∏≠‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î', '‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏Å‡∏£‡∏≠‡∏Å‡∏´‡∏±‡∏ß‡∏Ç‡πâ‡∏≠‡πÅ‡∏•‡∏∞‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°');
                return;
            }
            
            const broadcast = {
                id: 'broadcast_' + Date.now(),
                title: urgent ? 'üö® ' + title : 'üì¢ ' + title,
                message: message,
                time: new Date().toISOString(),
                urgent: urgent,
                sender: userName
            };
            
            broadcasts.unshift(broadcast);
            if (broadcasts.length > 50) broadcasts = broadcasts.slice(0, 50);
            saveData();
            
            // ‡∏•‡πâ‡∏≤‡∏á‡∏ü‡∏≠‡∏£‡πå‡∏°
            document.getElementById('broadcastTitle').value = '';
            document.getElementById('broadcastMessage').value = '';
            
            // ‡πÅ‡∏™‡∏î‡∏á‡∏Å‡∏≤‡∏£‡πÅ‡∏à‡πâ‡∏á‡πÄ‡∏ï‡∏∑‡∏≠‡∏ô
            showNotification(broadcast.title, broadcast.message);
            
            // ‡∏ñ‡πâ‡∏≤‡πÄ‡∏õ‡πá‡∏ô‡∏õ‡∏£‡∏∞‡∏Å‡∏≤‡∏®‡∏î‡πà‡∏ß‡∏ô
            if (urgent) {
                playEmergencySound();
                vibrate([1000, 500, 1000]);
            }
            
            updateBroadcastsList();
            
            // ‡∏à‡∏≥‡∏•‡∏≠‡∏á‡∏™‡πà‡∏á‡πÑ‡∏õ‡∏¢‡∏±‡∏á‡∏≠‡∏∏‡∏õ‡∏Å‡∏£‡∏ì‡πå‡∏≠‡∏∑‡πà‡∏ô
            if (urgent) {
                showNotification('‡∏õ‡∏£‡∏∞‡∏Å‡∏≤‡∏®‡∏î‡πà‡∏ß‡∏ô', '‡∏™‡πà‡∏á‡∏õ‡∏£‡∏∞‡∏Å‡∏≤‡∏®‡∏î‡πà‡∏ß‡∏ô‡πÑ‡∏õ‡∏¢‡∏±‡∏á‡∏ó‡∏∏‡∏Å‡∏≠‡∏∏‡∏õ‡∏Å‡∏£‡∏ì‡πå‡πÅ‡∏•‡πâ‡∏ß');
            }
        }
        
        // ‡∏≠‡∏±‡∏û‡πÄ‡∏î‡∏ï‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡πÅ‡∏à‡πâ‡∏á‡πÄ‡∏ï‡∏∑‡∏≠‡∏ô
        function updateAlarmsList() {
            const container = document.getElementById('alarmsList');
            const filteredAlarms = getFilteredAlarms();
            
            if (filteredAlarms.length === 0) {
                container.innerHTML = '<div class="alarm-item">‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡∏°‡∏µ‡πÅ‡∏à‡πâ‡∏á‡πÄ‡∏ï‡∏∑‡∏≠‡∏ô</div>';
                return;
            }
            
            container.innerHTML = '';
            filteredAlarms.forEach(alarm => {
                const alarmTime = new Date(alarm.datetime);
                const isPast = alarmTime < new Date();
                const isTriggered = alarm.triggered;
                
                const alarmElement = document.createElement('div');
                alarmElement.className = `alarm-item ${alarm.type} ${alarm.priority === 'high' ? 'urgent' : ''}`;
                
                let statusText = '';
                if (isTriggered) {
                    statusText = '<span style="color:#4caf50">‚úì ‡πÅ‡∏à‡πâ‡∏á‡πÄ‡∏ï‡∏∑‡∏≠‡∏ô‡πÅ‡∏•‡πâ‡∏ß</span>';
                } else if (isPast) {
                    statusText = '<span style="color:#ff9800">‚è∞ ‡πÄ‡∏•‡∏¢‡πÄ‡∏ß‡∏•‡∏≤</span>';
                } else {
                    const timeLeft = getTimeLeft(alarmTime);
                    statusText = `<span style="color:#64b5f6">‚è≥ ${timeLeft}</span>`;
                }
                
                alarmElement.innerHTML = `
                    <div style="display: flex; justify-content: space-between; align-items: start;">
                        <div>
                            <strong>${alarm.title}</strong>
                            <div style="font-size: 14px; color: #ccc; margin-top: 5px;">
                                ${alarm.description || '‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏£‡∏≤‡∏¢‡∏•‡∏∞‡πÄ‡∏≠‡∏µ‡∏¢‡∏î'}
                            </div>
                            <div style="margin-top: 10px;">
                                <span class="badge badge-${alarm.type}">
                                    ${alarm.type === 'public' ? 'üåê ‡∏™‡∏≤‡∏ò‡∏≤‡∏£‡∏ì‡∏∞' : 'üîí ‡∏™‡πà‡∏ß‡∏ô‡∏ï‡∏±‡∏ß'}
                                </span>
                                <span class="badge" style="background: ${getPriorityColor(alarm.priority)}">
                                    ${alarm.priority === 'high' ? '‡∏™‡∏π‡∏á' : alarm.priority === 'medium' ? '‡∏Å‡∏•‡∏≤‡∏á' : '‡∏ï‡πà‡∏≥'}
                                </span>
                            </div>
                        </div>
                        <div style="text-align: right;">
                            <div style="font-size: 12px; color: #999;">
                                ${formatTime(alarmTime)}
                            </div>
                            <div style="font-size: 12px; margin-top: 5px;">
                                ${statusText}
                            </div>
                        </div>
                    </div>
                    <div style="margin-top: 10px; display: flex; gap: 5px;">
                        ${!isTriggered ? `
                            <button onclick="testAlarm('${alarm.id}')" style="padding: 5px 10px; font-size: 12px;">
                                ‡∏ó‡∏î‡∏™‡∏≠‡∏ö
                            </button>
                        ` : ''}
                        <button onclick="deleteAlarm('${alarm.id}')" style="padding: 5px 10px; font-size: 12px; background: #d32f2f;">
                            ‡∏•‡∏ö
                        </button>
                    </div>
                `;
                
                container.appendChild(alarmElement);
            });
        }
        
        // ‡∏≠‡∏±‡∏û‡πÄ‡∏î‡∏ï‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡∏õ‡∏£‡∏∞‡∏Å‡∏≤‡∏®
        function updateBroadcastsList() {
            const container = document.getElementById('broadcastsList');
            const recentBroadcasts = broadcasts.slice(0, 5);
            
            if (recentBroadcasts.length === 0) {
                container.innerHTML = '<div style="color:#999; text-align:center;">‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏õ‡∏£‡∏∞‡∏Å‡∏≤‡∏®</div>';
                return;
            }
            
            container.innerHTML = '';
            recentBroadcasts.forEach(broadcast => {
                const broadcastTime = new Date(broadcast.time);
                const broadcastElement = document.createElement('div');
                broadcastElement.className = 'alarm-item';
                broadcastElement.style.borderLeftColor = broadcast.urgent ? '#d32f2f' : '#ff9800';
                broadcastElement.style.marginBottom = '10px';
                
                broadcastElement.innerHTML = `
                    <div><strong>${broadcast.title}</strong></div>
                    <div style="margin: 5px 0; color: #ccc;">${broadcast.message}</div>
                    <div style="display: flex; justify-content: space-between; color: #999; font-size: 12px;">
                        <span>‡∏à‡∏≤‡∏Å: ${broadcast.sender}</span>
                        <span>${formatTime(broadcastTime)}</span>
                    </div>
                `;
                
                container.appendChild(broadcastElement);
            });
        }
        
        // ‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô‡∏ä‡πà‡∏ß‡∏¢‡πÄ‡∏´‡∏•‡∏∑‡∏≠
        function formatDateTime(date) {
            return date.toISOString().slice(0, 16);
        }
        
        function formatTime(date) {
            return date.toLocaleTimeString('th-TH', { 
                hour: '2-digit', 
                minute: '2-digit',
                day: 'numeric',
                month: 'short'
            });
        }
        
        function getTimeLeft(targetDate) {
            const now = new Date();
            const diff = targetDate - now;
            
            if (diff <= 0) return '‡∏ñ‡∏∂‡∏á‡πÄ‡∏ß‡∏•‡∏≤‡πÅ‡∏•‡πâ‡∏ß';
            
            const days = Math.floor(diff / (1000 * 60 * 60 * 24));
            const hours = Math.floor((diff % (1000 * 60 * 60 * 24)) / (1000 * 60 * 60));
            const minutes = Math.floor((diff % (1000 * 60 * 60)) / (1000 * 60));
            
            if (days > 0) return `${days} ‡∏ß‡∏±‡∏ô ${hours} ‡∏ä‡∏°.`;
            if (hours > 0) return `${hours} ‡∏ä‡∏°. ${minutes} ‡∏ô‡∏≤‡∏ó‡∏µ`;
            return `${minutes} ‡∏ô‡∏≤‡∏ó‡∏µ`;
        }
        
        function getFilteredAlarms() {
            const now = new Date();
            const today = new Date();
            today.setHours(0, 0, 0, 0);
            
            switch(currentFilter) {
                case 'private':
                    return alarms.filter(a => a.type === 'private');
                case 'public':
                    return alarms.filter(a => a.type === 'public');
                case 'today':
                    return alarms.filter(a => {
                        const alarmDate = new Date(a.datetime);
                        alarmDate.setHours(0, 0, 0, 0);
                        return alarmDate.getTime() === today.getTime();
                    });
                default:
                    return alarms;
            }
        }
        
        function getPriorityColor(priority) {
            switch(priority) {
                case 'high': return '#d32f2f';
                case 'medium': return '#1976d2';
                case 'low': return '#388e3c';
                default: return '#757575';
            }
        }
        
        // ‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô UI
        function setAlarmType(type) {
            currentAlarmType = type;
            
            document.getElementById('btnPrivate').className = type === 'private' ? 'btn-primary' : '';
            document.getElementById('btnPublic').className = type === 'public' ? 'btn-primary' : '';
        }
        
        function setPriority(priority) {
            currentPriority = priority;
            
            document.getElementById('btnLow').className = priority === 'low' ? 'btn-primary' : '';
            document.getElementById('btnMedium').className = priority === 'medium' ? 'btn-primary' : '';
            document.getElementById('btnHigh').className = priority === 'high' ? 'btn-primary' : '';
        }
        
        function filterAlarms(filter) {
            currentFilter = filter;
            
            document.getElementById('filterAll').className = filter === 'all' ? 'btn-primary' : '';
            document.getElementById('filterPrivate').className = filter === 'private' ? 'btn-primary' : '';
            document.getElementById('filterPublic').className = filter === 'public' ? 'btn-primary' : '';
            document.getElementById('filterToday').className = filter === 'today' ? 'btn-primary' : '';
            
            updateAlarmsList();
        }
        
        function deleteAlarm(id) {
            if (confirm('‡∏•‡∏ö‡πÅ‡∏à‡πâ‡∏á‡πÄ‡∏ï‡∏∑‡∏≠‡∏ô‡∏ô‡∏µ‡πâ?')) {
                alarms = alarms.filter(a => a.id !== id);
                saveData();
                updateAlarmsList();
                showNotification('‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à', '‡∏•‡∏ö‡πÅ‡∏à‡πâ‡∏á‡πÄ‡∏ï‡∏∑‡∏≠‡∏ô‡πÅ‡∏•‡πâ‡∏ß');
            }
        }
        
        function testAlarm(id) {
            const alarm = alarms.find(a => a.id === id);
            if (alarm) {
                showNotification('üîî ‡∏ó‡∏î‡∏™‡∏≠‡∏ö: ' + alarm.title, alarm.description || '‡∏ô‡∏µ‡πà‡∏Ñ‡∏∑‡∏≠‡∏Å‡∏≤‡∏£‡∏ó‡∏î‡∏™‡∏≠‡∏ö');
                playSound();
            }
        }
        
        // ‡πÅ‡∏™‡∏î‡∏á‡∏Å‡∏≤‡∏£‡πÅ‡∏à‡πâ‡∏á‡πÄ‡∏ï‡∏∑‡∏≠‡∏ô
        function showNotification(title, message) {
            const notif = document.getElementById('notification');
            document.getElementById('notifTitle').textContent = title;
            document.getElementById('notifMessage').textContent = message;
            
            notif.classList.add('show');
            
            // ‡∏õ‡∏¥‡∏î‡∏≠‡∏±‡∏ï‡πÇ‡∏ô‡∏°‡∏±‡∏ï‡∏¥‡∏´‡∏•‡∏±‡∏á‡∏à‡∏≤‡∏Å 5 ‡∏ß‡∏¥‡∏ô‡∏≤‡∏ó‡∏µ
            setTimeout(() => {
                notif.classList.remove('show');
            }, 5000);
        }
        
        function closeNotification() {
            document.getElementById('notification').classList.remove('show');
        }
        
        function showEmergencyAlert(alarm) {
            // ‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏´‡∏ô‡πâ‡∏≤‡∏ï‡πà‡∏≤‡∏á‡πÅ‡∏à‡πâ‡∏á‡πÄ‡∏ï‡∏∑‡∏≠‡∏ô‡∏â‡∏∏‡∏Å‡πÄ‡∏â‡∏¥‡∏ô
            const emergencyDiv = document.createElement('div');
            emergencyDiv.style.cssText = `
                position: fixed;
                top: 0;
                left: 0;
                right: 0;
                bottom: 0;
                background: rgba(211, 47, 47, 0.9);
                display: flex;
                flex-direction: column;
                justify-content: center;
                align-items: center;
                z-index: 9999;
                animation: pulse 0.5s infinite;
            `;
            
            emergencyDiv.innerHTML = `
                <h1 style="color: white; margin-bottom: 20px;">üö® ${alarm.title}</h1>
                <p style="color: white; font-size: 20px; margin-bottom: 30px;">
                    ${alarm.description || '‡∏Å‡∏≤‡∏£‡πÅ‡∏à‡πâ‡∏á‡πÄ‡∏ï‡∏∑‡∏≠‡∏ô‡∏î‡πà‡∏ß‡∏ô!'}
                </p>
                <button onclick="this.parentElement.remove()" style="
                    padding: 15px 30px;
                    font-size: 18px;
                    background: white;
                    color: #d32f2f;
                    border: none;
                    border-radius: 10px;
                    cursor: pointer;
                ">
                    ‡∏õ‡∏¥‡∏î‡∏Å‡∏≤‡∏£‡πÅ‡∏à‡πâ‡∏á‡πÄ‡∏ï‡∏∑‡∏≠‡∏ô
                </button>
            `;
            
            document.body.appendChild(emergencyDiv);
            
            // ‡∏•‡∏ö‡∏≠‡∏±‡∏ï‡πÇ‡∏ô‡∏°‡∏±‡∏ï‡∏¥‡∏´‡∏•‡∏±‡∏á‡∏à‡∏≤‡∏Å 30 ‡∏ß‡∏¥‡∏ô‡∏≤‡∏ó‡∏µ
            setTimeout(() => {
                if (emergencyDiv.parentElement) {
                    emergencyDiv.remove();
                }
            }, 30000);
        }
        
        // ‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô‡πÄ‡∏™‡∏µ‡∏¢‡∏á‡πÅ‡∏•‡∏∞‡∏Å‡∏≤‡∏£‡∏™‡∏±‡πà‡∏ô
        function playSound() {
            try {
                // ‡∏™‡∏£‡πâ‡∏≤‡∏á‡πÄ‡∏™‡∏µ‡∏¢‡∏á‡πÄ‡∏ö‡∏∑‡πâ‡∏≠‡∏á‡∏ï‡πâ‡∏ô
                const audioContext = new (window.AudioContext || window.webkitAudioContext)();
                const oscillator = audioContext.createOscillator();
                const gainNode = audioContext.createGain();
                
                oscillator.connect(gainNode);
                gainNode.connect(audioContext.destination);
                
                oscillator.frequency.value = 800;
                oscillator.type = 'sine';
                
                gainNode.gain.setValueAtTime(0, audioContext.currentTime);
                gainNode.gain.linearRampToValueAtTime(0.3, audioContext.currentTime + 0.1);
                gainNode.gain.linearRampToValueAtTime(0, audioContext.currentTime + 0.5);
                
                oscillator.start();
                setTimeout(() => oscillator.stop(), 500);
            } catch (e) {
                console.log('‡πÑ‡∏°‡πà‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡πÄ‡∏•‡πà‡∏ô‡πÄ‡∏™‡∏µ‡∏¢‡∏á‡πÑ‡∏î‡πâ');
            }
        }
        
        function playEmergencySound() {
            try {
                const audioContext = new (window.AudioContext || window.webkitAudioContext)();
                const oscillator1 = audioContext.createOscillator();
                const oscillator2 = audioContext.createOscillator();
                const gainNode = audioContext.createGain();
                
                oscillator1.connect(gainNode);
                oscillator2.connect(gainNode);
                gainNode.connect(audioContext.destination);
                
                oscillator1.frequency.setValueAtTime(600, audioContext.currentTime);
                oscillator1.frequency.exponentialRampToValueAtTime(1200, audioContext.currentTime + 0.5);
                
                oscillator2.frequency.setValueAtTime(800, audioContext.currentTime);
                oscillator2.frequency.exponentialRampToValueAtTime(1600, audioContext.currentTime + 0.5);
                
                gainNode.gain.setValueAtTime(0, audioContext.currentTime);
                gainNode.gain.linearRampToValueAtTime(0.5, audioContext.currentTime + 0.1);
                gainNode.gain.exponentialRampToValueAtTime(0.01, audioContext.currentTime + 1);
                
                oscillator1.start();
                oscillator2.start();
                
                setTimeout(() => {
                    oscillator1.stop();
                    oscillator2.stop();
                }, 1000);
            } catch (e) {
                console.log('‡πÑ‡∏°‡πà‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡πÄ‡∏•‡πà‡∏ô‡πÄ‡∏™‡∏µ‡∏¢‡∏á‡∏î‡πà‡∏ß‡∏ô‡πÑ‡∏î‡πâ');
            }
        }
        
        function vibrate(pattern = [200, 100, 200]) {
            if (navigator.vibrate) {
                navigator.vibrate(pattern);
            }
        }
        
        // ‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô‡∏ó‡∏î‡∏™‡∏≠‡∏ö
        function testNotification() {
            showNotification('üîî ‡∏ó‡∏î‡∏™‡∏≠‡∏ö‡∏Å‡∏≤‡∏£‡πÅ‡∏à‡πâ‡∏á‡πÄ‡∏ï‡∏∑‡∏≠‡∏ô', '‡∏ô‡∏µ‡πà‡∏Ñ‡∏∑‡∏≠‡∏Å‡∏≤‡∏£‡∏ó‡∏î‡∏™‡∏≠‡∏ö‡∏Å‡∏≤‡∏£‡πÅ‡∏à‡πâ‡∏á‡πÄ‡∏ï‡∏∑‡∏≠‡∏ô‡∏õ‡∏Å‡∏ï‡∏¥');
            playSound();
            vibrate();
        }
        
        function testBackground() {
            if ('serviceWorker' in navigator && 'PushManager' in window) {
                showNotification('‡∏ó‡∏î‡∏™‡∏≠‡∏ö‡πÄ‡∏ö‡∏∑‡πâ‡∏≠‡∏á‡∏´‡∏•‡∏±‡∏á', '‡∏£‡∏∞‡∏ö‡∏ö‡πÅ‡∏à‡πâ‡∏á‡πÄ‡∏ï‡∏∑‡∏≠‡∏ô‡πÄ‡∏ö‡∏∑‡πâ‡∏≠‡∏á‡∏´‡∏•‡∏±‡∏á‡∏û‡∏£‡πâ‡∏≠‡∏°‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô');
                
                // ‡∏™‡∏£‡πâ‡∏≤‡∏á‡πÅ‡∏à‡πâ‡∏á‡πÄ‡∏ï‡∏∑‡∏≠‡∏ô‡∏ó‡∏µ‡πà‡∏à‡∏∞‡∏ó‡∏≥‡∏á‡∏≤‡∏ô‡πÉ‡∏ô‡∏≠‡∏ô‡∏≤‡∏Ñ‡∏ï
                const testAlarm = {
                    id: 'test_bg_' + Date.now(),
                    title: '‡∏ó‡∏î‡∏™‡∏≠‡∏ö‡πÅ‡∏à‡πâ‡∏á‡πÄ‡∏ï‡∏∑‡∏≠‡∏ô‡πÄ‡∏ö‡∏∑‡πâ‡∏≠‡∏á‡∏´‡∏•‡∏±‡∏á',
                    description: '‡πÅ‡∏à‡πâ‡∏á‡πÄ‡∏ï‡∏∑‡∏≠‡∏ô‡∏ô‡∏µ‡πâ‡∏à‡∏∞‡∏ó‡∏≥‡∏á‡∏≤‡∏ô‡πÅ‡∏°‡πâ‡∏õ‡∏¥‡∏î‡πÅ‡∏≠‡∏õ',
                    datetime: new Date(Date.now() + 10000).toISOString(), // 10 ‡∏ß‡∏¥‡∏ô‡∏≤‡∏ó‡∏µ‡∏à‡∏≤‡∏Å‡∏ô‡∏µ‡πâ
                    type: 'private',
                    priority: 'medium',
                    triggered: false,
                    deviceId: deviceId,
                    userName: userName
                };
                
                alarms.push(testAlarm);
                saveData();
                updateAlarmsList();
                
                showNotification('‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏ó‡∏î‡∏™‡∏≠‡∏ö', '‡∏õ‡∏¥‡∏î‡πÅ‡∏≠‡∏õ‡∏´‡∏£‡∏∑‡∏≠‡∏•‡πá‡∏≠‡∏Ñ‡∏´‡∏ô‡πâ‡∏≤‡∏à‡∏≠ ‡∏£‡∏≠ 10 ‡∏ß‡∏¥‡∏ô‡∏≤‡∏ó‡∏µ');
            } else {
                showNotification('‡πÑ‡∏°‡πà‡∏£‡∏≠‡∏á‡∏£‡∏±‡∏ö', '‡πÄ‡∏ö‡∏£‡∏≤‡∏ß‡πå‡πÄ‡∏ã‡∏≠‡∏£‡πå‡∏ô‡∏µ‡πâ‡πÑ‡∏°‡πà‡∏£‡∏≠‡∏á‡∏£‡∏±‡∏ö‡∏Å‡∏≤‡∏£‡πÅ‡∏à‡πâ‡∏á‡πÄ‡∏ï‡∏∑‡∏≠‡∏ô‡πÄ‡∏ö‡∏∑‡πâ‡∏≠‡∏á‡∏´‡∏•‡∏±‡∏á');
            }
        }
        
        // ‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô‡∏≠‡∏∑‡πà‡∏ô‡πÜ
        function updateTime() {
            // ‡∏≠‡∏±‡∏û‡πÄ‡∏î‡∏ï‡πÄ‡∏ß‡∏•‡∏≤‡∏õ‡∏±‡∏à‡∏à‡∏∏‡∏ö‡∏±‡∏ô‡πÉ‡∏ô UI
            console.log('‡∏≠‡∏±‡∏û‡πÄ‡∏î‡∏ï‡πÄ‡∏ß‡∏•‡∏≤:', new Date().toLocaleTimeString());
        }
        
        function checkConnection() {
            const status = navigator.onLine ? '‡∏≠‡∏≠‡∏ô‡πÑ‡∏•‡∏ô‡πå' : '‡∏≠‡∏≠‡∏ü‡πÑ‡∏•‡∏ô‡πå';
            const statusDiv = document.getElementById('connectionStatus');
            const statusText = document.getElementById('statusText');
            
            statusText.textContent = status;
            statusDiv.className = `status ${navigator.onLine ? 'online' : 'offline'}`;
        }
        
        function exportData() {
            const data = {
                alarms: alarms,
                broadcasts: broadcasts,
                exportDate: new Date().toISOString()
            };
            
            const dataStr = JSON.stringify(data, null, 2);
            const dataUri = 'data:application/json;charset=utf-8,' + encodeURIComponent(dataStr);
            
            const link = document.createElement('a');
            link.setAttribute('href', dataUri);
            link.setAttribute('download', 'alarms_backup_' + new Date().toISOString().split('T')[0] + '.json');
            link.click();
            
            showNotification('‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à', '‡∏™‡∏≥‡∏£‡∏≠‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÄ‡∏£‡∏µ‡∏¢‡∏ö‡∏£‡πâ‡∏≠‡∏¢‡πÅ‡∏•‡πâ‡∏ß');
        }
        
        // ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏Å‡∏≤‡∏£‡πÄ‡∏ä‡∏∑‡πà‡∏≠‡∏°‡∏ï‡πà‡∏≠‡πÄ‡∏°‡∏∑‡πà‡∏≠‡πÇ‡∏´‡∏•‡∏î
        checkConnection();
        window.addEventListener('online', checkConnection);
        window.addEventListener('offline', checkConnection);
    </script>
</body>
</html>
